(function(c){var a,b,e,d,f;c.fn.editable=function(i,g){var h;if((typeof i==="function")||!i){h=c.extend({},c.fn.editable.defaults);if(typeof g==="object"){h=c.extend(h,g)}h.changeCallback=i;return this.each(function(){a.call(this,h)})}};a=function(r){var o=this,g,i,j={},h,k,n,q,p,l,m;h=function(z){var x,A,v,w,s=false,y,t,u;l();j.style=c(o).attr("style");j.text=f(c(o).html());j.height=c(o).outerHeight();w=j.text;if(typeof r.data==="function"){w=r.data.call(o,j.text,o)}else{if(typeof r.data==="string"){w=r.data}}g=c('<form class="editable-lite-form">');i=k(r.type,o);i.css("font-size",b(o,"font-size"));i.css("font-family",b(o,"font-family"));i.css("color",b(o,"color"));x=function(C){var B=b(C,"background-color");if(!B||B==="transparent"||B==="inherit"){if(c(C).parent().length){x(c(C).parent()[0])}else{return B}}};i.css("background-color",x(o));A=c("<span>&nbsp;</span>");c(o).prepend(A);g.css("position","absolute").css("margin","0").css("padding","0").css("z-index",r.zIndex).css("left",r.offsetY+c(A).position().left+"px").append(i);m=true;u=function(){if(m){g.css("top",r.offsetY+c(o).position().top+"px");setTimeout(u,250)}};u();v=c(A).position().left-c(o).position().left;i.css("padding",0).css("margin",0).css("width",(c(o).outerWidth()-r.assumedBorderWidth-v+(r.widen||0))+"px");A.remove();i.val(w);c(o).css("height",c(o).height()+"px").text("");c(o).append(g);setTimeout(function(){j.inputHeight=c(i).height()},1);c(i).focus();c(i).blur(function(B){if(!s){s=true;if(r.acceptChangesOnBlur){setTimeout(q,1)}else{setTimeout(n,1)}c(i).unbind("blur")}});setTimeout(function(){c("html").bind("click.editable",function(){c(i).trigger("blur")})},1);c(i).click(function(B){B.stopPropagation()});c(i).keydown(function(B){if(!s){if(B.which===13){if((r.type==="textarea")&&(B.ctrlKey||B.altKey||B.shiftKey)){B.stopPropagation()}else{s=true;setTimeout(q,1)}}else{if(B.which===27){s=true;setTimeout(n,1)}else{if(B.which===9){s=true;setTimeout(q,1)}}}}if(!s&&(r.type==="textarea")&&(r.autoResize)){if(c(i).height()>j.inputHeight){c(o).css("height",(j.height+c(i).height()-j.inputHeight+10)+"px")}}});y={keydown:"onKeyDown",keyup:"onKeyUp",keypress:"onKeyPress"};t=function(C,B){c(i).bind(B,function(D){C.call(this,D)})};c.each(y,function(B,C){var D=r[C];if(c.isFunction(D)){t(D,B)}})};k=function(s,u){var t;if(s==="textarea"){t=c('<textarea name="value"></textarea>');if(r.autoResize){t.TextAreaExpander(false,r.autoResizeMax)}else{t.css("height",c(u).height()+"px")}}else{t=c('<input type="text" name="value">');if(r.maxLength){t.attr("maxlength",r.maxLength)}if(r.autoComplete){t.attr("autocomplete","off");t.autocomplete({source:(c.isArray(r.autoComplete)?r.autoComplete:r.autoComplete()),minLength:0,delay:0})}}return t};n=function(t){var u=typeof t!=="undefined"?t:j.text,s=d(u);c(o).attr("style",j.style||"").html(s).append(g);c(o).data("editable-active",false);setTimeout(function(){g.hide().remove();c(o).find("form.editable-lite-form").remove();p()},20);if((typeof t==="undefined")&&(typeof r.noChange==="function")){r.noChange.call(o,u)}c("html").unbind("click.editable");m=false};q=function(){var s;if(i.val()!==j.text){s=r.changeCallback.call(o,i.val(),o);if(s){n(s)}else{n(i.val())}}else{n()}};p=function(){if(r.placeHolder&&(c(o).html().replace(/\s+/g,"")==="")){c(o).html(r.placeHolder)}};l=function(){if(r.placeHolder&&(c(o).html()===r.placeHolder)){c(o).html("")}};c(this).click(function(s){if(c(o).data("editable-active")!=="true"){c(o).data("editable-active","true");if(r.displayDelay){setTimeout(function(){h()},r.displayDelay)}else{h()}}});p()};b=function(k,j){if(k.currentStyle){var h=0,g="",l=false;for(h=0;h<j.length;h=h+1){if(j[h]!=="-"){g+=(l?j[h].toUpperCase():j[h]);l=false}else{l=true}}j=g;return k.currentStyle[j]}else{return getComputedStyle(k,null).getPropertyValue(j)}};e=function(g){if(g){return c("<span/>").text(g).html()}else{return""}};d=function(j){var g,h;if(typeof j==="string"){g=j.split(/\r\n|\r|\n/);for(h=0;h<g.length;h=h+1){g[h]=e(g[h])}return g.join("<br/>")}else{return""}};f=function(g){g=g.split(/<br\s*\/?\s*>/);g=c.map(g,function(h){return c("<span/>").html(h).text()}).join("\n");return g};c.fn.editable.defaults={type:"text",offsetX:0,offsetY:0,assumedBorderWidth:4,acceptChangesOnBlur:true,data:false,maxLength:false,autoResize:false,autoResizeMax:300,noChange:false,placeHolder:false,autoComplete:false,zIndex:10000}}(jQuery));
